# ReadAssist å¼€å‘æ“ä½œæ‰‹å†Œ

æœ¬æ‰‹å†Œæä¾›äº†åœ¨ReadAssisté¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­åº”ç”¨é¡¹ç›®è§„åˆ™çš„è¯¦ç»†æ“ä½œæŒ‡å—ï¼Œç¡®ä¿æ‰€æœ‰å¼€å‘æ´»åŠ¨éµå¾ªä¸€è‡´çš„æµç¨‹å’Œæ ‡å‡†ã€‚

## ç›®å½•
1. [ä»£ç æ¶æ„æ“ä½œæŒ‡å—](#ä»£ç æ¶æ„æ“ä½œæŒ‡å—)
2. [æ–‡æ¡£æ›´æ–°æ“ä½œæŒ‡å—](#æ–‡æ¡£æ›´æ–°æ“ä½œæŒ‡å—)
3. [åŠŸèƒ½å¼€å‘æ“ä½œæŒ‡å—](#åŠŸèƒ½å¼€å‘æ“ä½œæŒ‡å—)
4. [é‡æ„æ“ä½œæŒ‡å—](#é‡æ„æ“ä½œæŒ‡å—)
5. [ä»£ç å®¡æŸ¥æ¸…å•](#ä»£ç å®¡æŸ¥æ¸…å•)
6. [è§„åˆ™ä¼˜å…ˆçº§ä¸å†²çªå¤„ç†](#è§„åˆ™ä¼˜å…ˆçº§ä¸å†²çªå¤„ç†)
7. [å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)

## ä»£ç æ¶æ„æ“ä½œæŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½æ—¶çš„æ¨¡å—é€‰æ‹©

1. **ç¡®å®šåŠŸèƒ½å½’å±**ï¼š
   - æŸ¥çœ‹ç°æœ‰ç®¡ç†å™¨ï¼Œç¡®å®šæ–°åŠŸèƒ½å±äºå“ªä¸ªèŒè´£èŒƒå›´
   - å¦‚æœå®Œå…¨æ— æ³•å½’ç±»ï¼Œè€ƒè™‘åˆ›å»ºæ–°çš„ç®¡ç†å™¨ç±»

2. **ä¿®æ”¹ç°æœ‰ç®¡ç†å™¨**ï¼š
   ```kotlin
   // åœ¨ChatWindowManager.ktä¸­æ·»åŠ æ–°åŠŸèƒ½
   fun addNewFeature() {
       // åŠŸèƒ½å®ç°
       Log.d(TAG, "âœ… æ–°åŠŸèƒ½å·²æ·»åŠ ")
       
       // å¦‚éœ€é€šçŸ¥æœåŠ¡ç±»ï¼Œä½¿ç”¨å›è°ƒ
       callbacks.onNewFeatureActivated()
   }
   ```

3. **åˆ›å»ºæ–°ç®¡ç†å™¨**ï¼š
   ```kotlin
   // 1. åˆ›å»ºæ–°ç®¡ç†å™¨ç±»
   package com.readassist.service.managers
   
   class NewFeatureManager(
       private val context: Context,
       private val callbacks: NewFeatureCallbacks
   ) {
       companion object {
           private const val TAG = "NewFeatureManager"
       }
       
       // æ¥å£å®šä¹‰
       interface NewFeatureCallbacks {
           fun onSomethingHappened(data: String)
       }
       
       // åŠŸèƒ½å®ç°
       fun doSomething() {
           // å®ç°
           callbacks.onSomethingHappened("ç»“æœ")
       }
   }
   
   // 2. åœ¨FloatingWindowServiceNewä¸­æ·»åŠ æ”¯æŒ
   class FloatingWindowServiceNew : Service(),
       NewFeatureManager.NewFeatureCallbacks {
       
       private lateinit var newFeatureManager: NewFeatureManager
       
       // åˆå§‹åŒ–
       private fun initializeManagers() {
           // å…¶ä»–ç®¡ç†å™¨åˆå§‹åŒ–...
           newFeatureManager = NewFeatureManager(this, this)
       }
       
       // å®ç°å›è°ƒ
       override fun onSomethingHappened(data: String) {
           // å¤„ç†å›è°ƒ
       }
   }
   ```

### ç®¡ç†å™¨é—´é€šä¿¡æ ‡å‡†æ“ä½œ

1. **æœåŠ¡ç±»ä½œä¸ºä¸­ä»‹**ï¼š
   ```kotlin
   // åœ¨FloatingWindowServiceNewä¸­
   override fun onTextSelected(text: String) {
       // æ–‡æœ¬é€‰æ‹©ç®¡ç†å™¨å›è°ƒæœåŠ¡ç±»
       chatWindowManager.importTextToInputField(text)
   }
   ```

2. **å¹¿æ’­é€šä¿¡**ï¼š
   ```kotlin
   // å‘é€å¹¿æ’­
   val intent = Intent("com.readassist.ACTION_NAME")
   intent.putExtra("key", "value")
   LocalBroadcastManager.getInstance(context).sendBroadcast(intent)
   ```

3. **çŠ¶æ€å…±äº«**ï¼š
   ```kotlin
   // ç®¡ç†å™¨æä¾›çŠ¶æ€æŸ¥è¯¢æ–¹æ³•
   fun getSelectionState(): Boolean = isTextSelectionActive
   
   // æœåŠ¡ç±»æŸ¥è¯¢çŠ¶æ€
   if (textSelectionManager.getSelectionState()) {
       // æ ¹æ®çŠ¶æ€æ‰§è¡Œæ“ä½œ
   }
   ```

## æ–‡æ¡£æ›´æ–°æ“ä½œæŒ‡å—

### ç‰ˆæœ¬æ›´æ–°æ–‡æ¡£æµç¨‹

å½“å®ŒæˆåŠŸèƒ½å¼€å‘æˆ–æ¶æ„è°ƒæ•´åï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ›´æ–°æ–‡æ¡£ï¼š

1. **æ›´æ–°CHANGELOG.md**ï¼š
   ```markdown
   ## v1.x.0 (yyyy-MM-dd)
   
   ### æ–°å¢åŠŸèƒ½
   - **åŠŸèƒ½åç§°**ï¼šç®€è¦æè¿°åŠŸèƒ½çš„ä¸»è¦ç‰¹ç‚¹
   - åˆ—å‡ºå­åŠŸèƒ½å’Œæ”¹è¿›ç‚¹
   
   ### ä¼˜åŒ–å’Œæ”¹è¿›
   - åˆ—å‡ºæ€§èƒ½ä¼˜åŒ–å’Œç”¨æˆ·ä½“éªŒæ”¹è¿›
   ```

2. **æ›´æ–°VERSION_NOTES.md**ï¼ˆå¦‚æœ‰æ¶æ„å˜æ›´ï¼‰ï¼š
   ```markdown
   # ReadAssist v1.x.0 ç‰ˆæœ¬è¯´æ˜æ–‡æ¡£
   
   ## èƒŒæ™¯ä¸ç›®æ ‡
   ç®€è¦è¯´æ˜å˜æ›´çš„èƒŒæ™¯å’Œç›®æ ‡
   
   ## å˜æ›´æ¦‚è¿°
   è¯¦ç»†æè¿°å˜æ›´å†…å®¹
   
   ## æ¶æ„è¯¦è§£
   è¯¦ç»†è¯´æ˜æ–°æ¶æ„çš„ç»„æˆå’Œå·¥ä½œåŸç†
   
   ## æ•ˆæœä¸æ”¶ç›Š
   è¯´æ˜å˜æ›´å¸¦æ¥çš„å¥½å¤„å’Œæ”¹è¿›
   ```

3. **æ›´æ–°DEVELOPER_GUIDE.md**ï¼š
   ```markdown
   # æ–°åŠŸèƒ½å¼€å‘æŒ‡å—
   
   ## ä½¿ç”¨æ–¹æ³•
   è¯¦ç»†è¯´æ˜å¦‚ä½•ä½¿ç”¨æ–°åŠŸèƒ½æˆ–æ–°æ¶æ„è¿›è¡Œå¼€å‘
   
   ## ç¤ºä¾‹ä»£ç 
   æä¾›å…·ä½“çš„ç¤ºä¾‹ä»£ç 
   ```

4. **æ›´æ–°README.md**ï¼š
   ```markdown
   ## æœ€æ–°æ›´æ–° (v1.x.0)
   
   ç®€è¦æè¿°æœ€æ–°ç‰ˆæœ¬çš„ä¸»è¦å˜æ›´å’Œæ–°åŠŸèƒ½ã€‚
   ```

### æ–‡æ¡£éªŒè¯æ¸…å•

åœ¨æäº¤æ–‡æ¡£æ›´æ–°å‰ï¼Œç¡®ä¿ï¼š

- [ ] ç‰ˆæœ¬å·å’Œæ—¥æœŸæ­£ç¡®
- [ ] æ‰€æœ‰åŠŸèƒ½å˜æ›´éƒ½å·²è®°å½•
- [ ] æ–‡æ¡£æ ¼å¼ç»Ÿä¸€ï¼Œæ— è¯­æ³•é”™è¯¯
- [ ] å¼€å‘æŒ‡å—ä¸å½“å‰ä»£ç ä¿æŒä¸€è‡´
- [ ] READMEä¸­åŒ…å«ç®€è¦çš„æ›´æ–°è¯´æ˜

## åŠŸèƒ½å¼€å‘æ“ä½œæŒ‡å—

### æ–°åŠŸèƒ½å¼€å‘æµç¨‹

1. **éœ€æ±‚åˆ†æä¸è®¾è®¡**ï¼š
   - æ˜ç¡®åŠŸèƒ½éœ€æ±‚å’Œä½¿ç”¨åœºæ™¯
   - ç¡®å®šå½±å“èŒƒå›´å’Œæ¶‰åŠç»„ä»¶
   - ç»˜åˆ¶ç®€å•çš„æµç¨‹å›¾æˆ–ç±»å›¾

2. **å¼€å‘ç¯å¢ƒå‡†å¤‡**ï¼š
   ```bash
   # ç¡®ä¿ä»£ç æœ€æ–°
   git pull origin main
   
   # åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
   git checkout -b feature/feature-name
   ```

3. **ä»£ç å®ç°**ï¼š
   - éµå¾ªæ¨¡å—åŒ–è®¾è®¡åŸåˆ™
   - æ·»åŠ é€‚å½“çš„æ—¥å¿—å’Œæ³¨é‡Š
   - ç¡®ä¿é”™è¯¯å¤„ç†å®Œå–„

4. **æµ‹è¯•**ï¼š
   ```kotlin
   // å•å…ƒæµ‹è¯•ç¤ºä¾‹
   @Test
   fun testNewFeature() {
       // å‡†å¤‡æµ‹è¯•æ•°æ®
       val manager = NewFeatureManager(mockContext, mockCallbacks)
       
       // æ‰§è¡Œæµ‹è¯•
       val result = manager.doSomething()
       
       // éªŒè¯ç»“æœ
       assertThat(result).isEqualTo(expectedValue)
   }
   ```

5. **æ–‡æ¡£æ›´æ–°**ï¼š
   - æŒ‰æ–‡æ¡£æ›´æ–°æµç¨‹æ›´æ–°ç›¸å…³æ–‡æ¡£
   - æ·»åŠ åŠŸèƒ½ä½¿ç”¨è¯´æ˜å’Œç¤ºä¾‹

6. **ä»£ç æäº¤**ï¼š
   ```bash
   # æäº¤ä»£ç 
   git add .
   git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½XXX"
   git push origin feature/feature-name
   ```

7. **åˆå¹¶è¯·æ±‚**ï¼š
   - åˆ›å»ºPull Request
   - ç­‰å¾…ä»£ç å®¡æŸ¥å’Œæµ‹è¯•
   - è§£å†³åé¦ˆé—®é¢˜
   - åˆå¹¶åˆ°ä¸»åˆ†æ”¯

## é‡æ„æ“ä½œæŒ‡å—

### å¤§å‹é‡æ„æ ‡å‡†æµç¨‹

1. **è§„åˆ’é˜¶æ®µ**ï¼š
   - æ˜ç¡®é‡æ„ç›®æ ‡å’ŒèŒƒå›´
   - åˆ¶å®šè¯¦ç»†çš„é‡æ„è®¡åˆ’
   - è¯†åˆ«æ½œåœ¨é£é™©å’Œç¼“è§£æªæ–½

2. **å®æ–½é‡æ„**ï¼š
   ```bash
   # åˆ›å»ºé‡æ„åˆ†æ”¯
   git checkout -b refactor/component-name
   ```

3. **ä¿ç•™æ—§ä»£ç **ï¼š
   ```kotlin
   // ä¿ç•™åŸæœ‰ä»£ç 
   class OriginalClass {
       // åŸæœ‰å®ç°
   }
   
   // åˆ›å»ºæ–°å®ç°
   class RefactoredClass {
       // æ–°å®ç°
   }
   ```

4. **å®ç°è¿ç§»ç­–ç•¥**ï¼š
   ```kotlin
   // åœ¨åˆé€‚çš„åœ°æ–¹æ·»åŠ è¿ç§»ä»£ç 
   if (shouldUseNewImplementation()) {
       // ä½¿ç”¨æ–°å®ç°
       newImpl.doSomething()
   } else {
       // ä½¿ç”¨æ—§å®ç°
       oldImpl.doSomething()
   }
   ```

5. **å…¨é¢æµ‹è¯•**ï¼š
   - å•å…ƒæµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£ç¡®æ€§
   - é›†æˆæµ‹è¯•éªŒè¯ç»„ä»¶äº¤äº’
   - ç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯ç”¨æˆ·åœºæ™¯

6. **æ–‡æ¡£æ›´æ–°**ï¼š
   - è¯¦ç»†è®°å½•æ¶æ„å˜æ›´
   - æ›´æ–°å¼€å‘æŒ‡å—
   - å‡†å¤‡è¿ç§»æŒ‡å—

7. **å¹³ç¨³è¿‡æ¸¡**ï¼š
   - é€æ­¥æ¨å‡ºæ–°å®ç°
   - ç›‘æ§æ€§èƒ½å’Œç¨³å®šæ€§
   - æ”¶é›†ç”¨æˆ·åé¦ˆ
   - è§£å†³å‘ç°çš„é—®é¢˜

8. **å®Œæˆè¿ç§»**ï¼š
   - åœ¨ç¡®è®¤ç¨³å®šåç§»é™¤æ—§å®ç°
   - æ›´æ–°æ‰€æœ‰ç›¸å…³æ–‡æ¡£
   - å®Œæˆæœ€ç»ˆä»£ç æ¸…ç†

## ä»£ç å®¡æŸ¥æ¸…å•

åœ¨è¿›è¡Œä»£ç å®¡æŸ¥æ—¶ï¼Œä½¿ç”¨ä»¥ä¸‹æ¸…å•ç¡®ä¿ä»£ç è´¨é‡ï¼š

### æ¶æ„åˆè§„æ€§

- [ ] éµå¾ªæ¨¡å—åŒ–è®¾è®¡åŸåˆ™
- [ ] ç®¡ç†å™¨èŒè´£æ¸…æ™°ï¼Œä¸åŒ…å«ä¸ç›¸å…³åŠŸèƒ½
- [ ] ä¾èµ–æ³¨å…¥æ­£ç¡®å®ç°
- [ ] æ¥å£è®¾è®¡åˆç†ï¼Œæ— å†—ä½™æ–¹æ³•

### ä»£ç è´¨é‡

- [ ] ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œç¬¦åˆé¡¹ç›®è§„èŒƒ
- [ ] å‘½åæ¸…æ™°ï¼Œç¬¦åˆå‘½åçº¦å®š
- [ ] æ³¨é‡Šå……åˆ†ï¼Œè¯´æ˜å¤æ‚é€»è¾‘
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼ŒåŒ…å«é€‚å½“çš„æ—¥å¿—

### æ€§èƒ½è€ƒé‡

- [ ] æ— æ˜æ˜¾æ€§èƒ½é—®é¢˜ï¼ˆå¦‚ä¸»çº¿ç¨‹é˜»å¡ï¼‰
- [ ] èµ„æºæ­£ç¡®é‡Šæ”¾ï¼ˆå¦‚å…³é—­æ•°æ®åº“è¿æ¥ï¼‰
- [ ] å†…å­˜ä½¿ç”¨åˆç†ï¼Œæ— æ˜æ˜¾æ³„æ¼é£é™©
- [ ] å¼‚æ­¥æ“ä½œæ­£ç¡®å¤„ç†

### æ–‡æ¡£å®Œæ•´æ€§

- [ ] æ–‡æ¡£å·²æ›´æ–°ï¼Œåæ˜ å½“å‰å˜æ›´
- [ ] APIæ–‡æ¡£å®Œæ•´ï¼ŒåŒ…å«æ–¹æ³•è¯´æ˜
- [ ] ç¤ºä¾‹ä»£ç ä¸å®é™…å®ç°ä¸€è‡´
- [ ] ç‰ˆæœ¬å·å’Œæ—¥æœŸæ­£ç¡®

## è§„åˆ™ä¼˜å…ˆçº§ä¸å†²çªå¤„ç†

ReadAssisté¡¹ç›®ä½¿ç”¨å¤šä¸ªè§„åˆ™æ–‡ä»¶æ¥å®šä¹‰å¼€å‘æ ‡å‡†ï¼Œå¦‚ä½•æ­£ç¡®å¤„ç†è¿™äº›è§„åˆ™ä¹‹é—´çš„å…³ç³»éå¸¸é‡è¦ã€‚

### è§„åˆ™æ–‡ä»¶å…³ç³»å›¾

```
è§„åˆ™å±‚æ¬¡ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  10-project-rules.yaml     â”‚ â—„â”€â”€ é«˜å±‚é¡¹ç›®è§„åˆ™ä¸æµç¨‹è§„èŒƒ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚
â”‚  01-09 æŠ€æœ¯é¢†åŸŸè§„åˆ™        â”‚ â—„â”€â”€ å…·ä½“æŠ€æœ¯è§„èŒƒ
â”‚  (.cursor/rules/*)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®é™…åº”ç”¨æ–‡æ¡£              â”‚
â”‚  (DEVELOPER_GUIDE.mdç­‰)    â”‚ â—„â”€â”€ è§„åˆ™åº”ç”¨å’Œå®æ–½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§„åˆ™ä¼˜å…ˆçº§

å½“ä¸åŒè§„åˆ™ä¹‹é—´å­˜åœ¨æ½œåœ¨å†²çªæ—¶ï¼Œéµå¾ªä»¥ä¸‹ä¼˜å…ˆçº§åŸåˆ™ï¼š

1. **æœ€é«˜ä¼˜å…ˆçº§**ï¼šé¢†åŸŸç‰¹å®šçš„æŠ€æœ¯è§„åˆ™ï¼ˆ01-09å·è§„åˆ™æ–‡ä»¶ï¼‰
   - ä¾‹å¦‚ï¼šUIç›¸å…³å¼€å‘å¿…é¡»é¦–å…ˆç¬¦åˆ`01-eink-constraints.yaml`ä¸­çš„å¢¨æ°´å±çº¦æŸ

2. **ä¸­ç­‰ä¼˜å…ˆçº§**ï¼š`10-project-rules.yaml`ä¸­çš„é¡¹ç›®è§„åˆ™
   - è¿™äº›è§„åˆ™ä¸ºæ•´ä¸ªé¡¹ç›®æä¾›äº†ç»Ÿä¸€çš„å¼€å‘æµç¨‹å’Œè§„èŒƒ

3. **å‚è€ƒä¼˜å…ˆçº§**ï¼šå®æ–½æ–‡æ¡£ä¸­çš„å…·ä½“æŒ‡å¯¼
   - å¦‚DEVELOPER_GUIDE.mdå’Œæœ¬æ“ä½œæ‰‹å†Œä¸­çš„æŒ‡å¯¼

### å†²çªå¤„ç†æµç¨‹

å½“å‘ç°è§„åˆ™ä¹‹é—´å­˜åœ¨å†²çªæ—¶ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¤„ç†ï¼š

1. **è¯†åˆ«å†²çª**ï¼š
   ```
   # ä¾‹å¦‚ï¼šä¸¤ä¸ªè§„åˆ™å¯¹åŒä¸€é—®é¢˜æœ‰ä¸åŒè¦æ±‚
   # 01-eink-constraints.yaml: ä¸å…è®¸ä½¿ç”¨åŠ¨ç”»
   # æŸä¸ªUIåº“æŒ‡å—ï¼šæ¨èä½¿ç”¨è¿‡æ¸¡åŠ¨ç”»æå‡ä½“éªŒ
   ```

2. **æŸ¥é˜…ä¼˜å…ˆçº§**ï¼š
   ```
   # ç¡®å®šå“ªä¸ªè§„åˆ™ä¼˜å…ˆçº§æ›´é«˜
   # åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ01-eink-constraints.yamlçš„è§„åˆ™ä¼˜å…ˆçº§æ›´é«˜
   ```

3. **è®°å½•å†³ç­–**ï¼š
   ```
   # åœ¨ä»£ç æ³¨é‡Šä¸­è¯´æ˜å†³ç­–
   // æ³¨æ„ï¼šæ ¹æ®å¢¨æ°´å±çº¦æŸ(01-eink-constraints)ï¼Œ
   // æ­¤å¤„ä¸ä½¿ç”¨æ ‡å‡†çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œè€Œæ˜¯ä½¿ç”¨é™æ€åˆ‡æ¢
   ```

4. **æŠ¥å‘Šå†²çª**ï¼š
   ```bash
   # é€šè¿‡é¡¹ç›®ç®¡ç†ç³»ç»ŸæŠ¥å‘Šå†²çª
   # åˆ›å»ºä¸€ä¸ªé—®é¢˜ï¼š"è§„åˆ™å†²çªï¼šåŠ¨ç”»ä½¿ç”¨çº¦æŸä¸UIåº“æœ€ä½³å®è·µå†²çª"
   ```

5. **å¯»æ±‚æ¾„æ¸…**ï¼š
   ```
   # é¡¹ç›®æ¶æ„å¸ˆæˆ–æŠ€æœ¯è´Ÿè´£äººåº”å½“è¯„å®¡å†²çªï¼Œå¹¶æ›´æ–°ç›¸å…³è§„åˆ™
   # å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼šåœ¨ä¸€ä¸ªè§„åˆ™ä¸­æ˜ç¡®å¼•ç”¨å¦ä¸€ä¸ªè§„åˆ™çš„ä¼˜å…ˆæ€§
   ```

### å®é™…åº”ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹1ï¼šUIç»„ä»¶å¼€å‘

å½“å¼€å‘å¢¨æ°´å±UIç»„ä»¶æ—¶ï¼š

```kotlin
// é¦–å…ˆéµå¾ª01-eink-constraints.yamlä¸­çš„åŸºæœ¬çº¦æŸ
// ğŸ‘Œ æ­£ç¡®ç¤ºä¾‹
class EinkButton : Button {
    init {
        // æ— åŠ¨ç”»ã€æ— æ¸å˜ã€é«˜å¯¹æ¯”åº¦
        setBackgroundColor(Color.WHITE)
        setTextColor(Color.BLACK)
        // ç¦ç”¨æ¶Ÿæ¼ªæ•ˆæœ
        stateListAnimator = null
    }
}

// âŒ é”™è¯¯ç¤ºä¾‹
class FancyButton : Button {
    init {
        // ä½¿ç”¨äº†æ¸å˜èƒŒæ™¯ã€åŠ¨ç”»æ•ˆæœ
        background = GradientDrawable()
        animate().alpha(0.8f).start() // è¿åå¢¨æ°´å±çº¦æŸ
    }
}
```

#### ç¤ºä¾‹2ï¼šæ¨¡å—åŒ–è®¾è®¡ä¸æ¶æ„è§„åˆ™

å½“è®¾è®¡æ–°åŠŸèƒ½æ—¶ï¼š

```kotlin
// éœ€è¦åŒæ—¶éµå¾ª:
// - 03-arch-design.yamlä¸­çš„MVVMæ¶æ„è§„åˆ™
// - 10-project-rules.yamlä¸­çš„æ¨¡å—åŒ–è®¾è®¡åŸåˆ™

// ğŸ‘Œ æ­£ç¡®ç¤ºä¾‹
// 1. åœ¨viewmodelåŒ…ä¸­åˆ›å»ºViewModel
class FeatureViewModel(
    private val repository: FeatureRepository // ä¾èµ–æ³¨å…¥
) : ViewModel() {
    // æ•°æ®å’Œä¸šåŠ¡é€»è¾‘
}

// 2. åœ¨service/managersåŒ…ä¸­åˆ›å»ºç®¡ç†å™¨
class FeatureManager(
    private val context: Context,
    private val callbacks: FeatureCallbacks // æ¥å£é€šä¿¡
) {
    // åŠŸèƒ½å®ç°
}

// âŒ é”™è¯¯ç¤ºä¾‹
// åœ¨UIå±‚ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œè¿åMVVMæ¶æ„
class FeatureActivity : AppCompatActivity() {
    fun loadData() {
        val database = AppDatabase.getInstance(this)
        val data = database.featureDao().getAll() // è¿åMVVMæ¶æ„è§„åˆ™
    }
}
```

### è§„åˆ™ç»´æŠ¤æµç¨‹

ä¸ºä¿è¯è§„åˆ™ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œå›¢é˜Ÿéœ€è¦å®šæœŸè¿›è¡Œè§„åˆ™ç»´æŠ¤ï¼š

1. **å­£åº¦è§„åˆ™å®¡æŸ¥**ï¼š
   - æ¯å­£åº¦ç”±æ¶æ„å¸ˆç‰µå¤´ï¼Œå®¡æŸ¥æ‰€æœ‰è§„åˆ™æ–‡ä»¶
   - è¯†åˆ«æ½œåœ¨å†²çªï¼Œæ›´æ–°è§„åˆ™é—´çš„å¼•ç”¨å…³ç³»

2. **è§„åˆ™å˜æ›´æµç¨‹**ï¼š
   ```
   a. æå‡ºå˜æ›´å»ºè®®
   b. è¯„ä¼°å¯¹ç°æœ‰è§„åˆ™çš„å½±å“
   c. æ›´æ–°ç›¸å…³è§„åˆ™æ–‡ä»¶
   d. åœ¨CHANGELOG.mdä¸­è®°å½•å˜æ›´
   e. é€šçŸ¥å›¢é˜Ÿå˜æ›´å†…å®¹
   ```

3. **è§„åˆ™è¦†ç›–æ£€æŸ¥**ï¼š
   - ç¡®ä¿æ¯ä¸ªæŠ€æœ¯é¢†åŸŸæœ‰å¯¹åº”çš„è§„åˆ™æ–‡ä»¶
   - ç¡®ä¿è§„åˆ™é—´æ²¡æœ‰æœªå¤„ç†çš„å†²çª

## å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 1. å¦‚ä½•å†³å®šæ˜¯ä¿®æ”¹ç°æœ‰ç®¡ç†å™¨è¿˜æ˜¯åˆ›å»ºæ–°ç®¡ç†å™¨ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å¦‚æœåŠŸèƒ½ä¸æŸä¸ªç°æœ‰ç®¡ç†å™¨çš„èŒè´£ç´§å¯†ç›¸å…³ï¼Œåº”ä¿®æ”¹ç°æœ‰ç®¡ç†å™¨
- å¦‚æœåŠŸèƒ½ä»£è¡¨ä¸€ä¸ªå…¨æ–°çš„èŒè´£é¢†åŸŸï¼Œåº”åˆ›å»ºæ–°ç®¡ç†å™¨
- å¦‚æœä¸ç¡®å®šï¼Œå¯ä»¥å…ˆåœ¨ç°æœ‰ç®¡ç†å™¨ä¸­å®ç°ï¼Œå¦‚æœå¯¼è‡´ç®¡ç†å™¨è¿‡äºè‡ƒè‚¿ï¼Œå†è€ƒè™‘æ‹†åˆ†

### 2. å¦‚ä½•å¤„ç†è·¨å¤šä¸ªç®¡ç†å™¨çš„åŠŸèƒ½ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åœ¨æœåŠ¡ç±»ä¸­å®ç°åè°ƒé€»è¾‘
- å°†åŠŸèƒ½æ‹†åˆ†åˆ°å„ä¸ªç®¡ç†å™¨ä¸­ï¼Œæ¯ä¸ªç®¡ç†å™¨è´Ÿè´£è‡ªå·±çš„éƒ¨åˆ†
- ä½¿ç”¨å›è°ƒæœºåˆ¶åœ¨ç®¡ç†å™¨é—´ä¼ é€’ä¿¡æ¯
- ç¤ºä¾‹ï¼š
  ```kotlin
  // åœ¨æœåŠ¡ç±»ä¸­
  fun handleComplexFeature() {
      textSelectionManager.processText { text ->
          screenshotManager.captureWithText(text) { bitmap ->
              aiCommunicationManager.analyzeImage(bitmap, text) { result ->
                  chatWindowManager.displayResult(result)
              }
          }
      }
  }
  ```

### 3. å¦‚ä½•å¤„ç†ç®¡ç†å™¨é—´çš„å¾ªç¯ä¾èµ–ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- é‡æ–°è®¾è®¡æ¥å£ï¼Œæ¶ˆé™¤å¾ªç¯ä¾èµ–
- ä½¿ç”¨æœåŠ¡ç±»ä½œä¸ºä¸­ä»‹ï¼Œè§£è€¦ç®¡ç†å™¨
- ä½¿ç”¨äº‹ä»¶æ€»çº¿æˆ–è§‚å¯Ÿè€…æ¨¡å¼
- è€ƒè™‘æ˜¯å¦ç®¡ç†å™¨èŒè´£åˆ’åˆ†ä¸å½“

### 4. æµ‹è¯•æ—¶å¦‚ä½•æ¨¡æ‹Ÿç®¡ç†å™¨ä¾èµ–ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ä¾èµ–æ³¨å…¥ä¾¿äºæµ‹è¯•
- ä½¿ç”¨mockæ¡†æ¶æ¨¡æ‹Ÿä¾èµ–
- ç¤ºä¾‹ï¼š
  ```kotlin
  @Test
  fun testFeature() {
      // åˆ›å»ºmockå¯¹è±¡
      val mockDependency = mockk<Dependency>()
      every { mockDependency.someMethod() } returns expectedValue
      
      // ä½¿ç”¨mockåˆ›å»ºè¢«æµ‹ç±»
      val manager = SomeManager(mockDependency)
      
      // æ‰§è¡Œæµ‹è¯•
      val result = manager.featureMethod()
      
      // éªŒè¯ç»“æœå’Œäº¤äº’
      verify { mockDependency.someMethod() }
      assertThat(result).isEqualTo(expectedValue)
  }
  ```

---

é€šè¿‡éµå¾ªæœ¬æ“ä½œæ‰‹å†Œçš„æŒ‡å¯¼ï¼Œå¼€å‘å›¢é˜Ÿå¯ä»¥ç¡®ä¿é¡¹ç›®çš„ä¸€è‡´æ€§ã€å¯ç»´æŠ¤æ€§å’Œè´¨é‡ã€‚éšç€é¡¹ç›®çš„å‘å±•ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ›´æ–°å’Œå®Œå–„æœ¬æ‰‹å†Œã€‚

æ–‡æ¡£ç¼–å†™ï¼šReadAssistå¼€å‘å›¢é˜Ÿ
æ—¥æœŸï¼š2024å¹´7æœˆ14æ—¥
ç‰ˆæœ¬ï¼šv1.0 